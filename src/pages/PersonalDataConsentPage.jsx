import React from "react";
import styles from "./pageCSS/SitePrivacyPage.module.css";

const introContent = [
  "Ссылка на документ: https://flatcher.su/consent"
];

const linkPattern = /(https?:\/\/[^\s"']+)|([A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,})/g;

const renderContentWithLinks = (line) => {
  if (typeof line !== "string") {
    return line;
  }

  const parts = [];
  let lastIndex = 0;

  line.replace(linkPattern, (match, urlMatch, emailMatch, offset) => {
    if (offset > lastIndex) {
      parts.push(line.slice(lastIndex, offset));
    }

    const isUrl = Boolean(urlMatch);
    const href = isUrl ? match : `mailto:${match}`;

    parts.push(
      <a
        key={`${href}-${offset}`}
        href={href}
        target={isUrl ? "_blank" : undefined}
        rel={isUrl ? "noopener noreferrer" : undefined}
      >
        {match}
      </a>
    );

    lastIndex = offset + match.length;
    return match;
  });

  if (lastIndex < line.length) {
    parts.push(line.slice(lastIndex));
  }

  return parts.length ? parts : line;
};

const sections = [
  {
    id: 1,
    title: "1. Общие положения",
    content: [
      "1.1. Настоящее Согласие на обработку персональных данных (далее – «Согласие») регулирует порядок обработки персональных данных субъектов персональных данных (далее – «Субъект») Индивидуальным предпринимателем Гусевым Никитой Олеговичем (ИНН: 772465913434, ОГРНИП: 325774600205503, адрес: 125373, г. Москва, Походный проезд, домовладение 3, стр. 2, e-mail: info@flatcher.su) (далее – «Оператор»).",
      "1.2. Согласие предоставляется в соответствии с Федеральным законом от 27.07.2006 № 152-ФЗ «О персональных данных», Федеральным законом от 13.03.2006 № 38-ФЗ «О рекламе», а также иными действующими нормативными правовыми актами Российской Федерации.",
      "1.3. Настоящее Согласие предоставляется посредством совершения Субъектом действий по оставлению данных на сайте https://flatcher.su (включая поддомены всех уровней) (далее – «Сайт»), а также иных действий, выражающих согласие на обработку персональных данных, в том числе на получение рекламной информации, как это предусмотрено Политикой обработки персональных данных и файлов Cookie, размещённой на Сайте по адресу: https://flatcher.su/data-processing (далее – «Политика»)."
    ],
  },
  {
    id: 2,
    title: "2. Цели обработки персональных данных",
    content: [
      "2.1. Обеспечение соблюдения требований законодательства Российской Федерации.",
      "2.2. Осуществление связи с Субъектом по оставленной заявке на Сайте, включая направление ответов в мессенджеры (WhatsApp, Telegram и иные).",
      "2.3. Информирование Субъекта о предоставляемых услугах и условиях их оказания, включая:",
      "2.3.1. направление маркетинговых и рекламных материалов по e-mail, SMS, мессенджерам;",
      "2.3.2. осуществление голосовых вызовов, включая массовый обзвон с рекламными целями;",
      "2.3.3. использование идентификаторов устройств, файлов Cookie и иных технологий отслеживания для персонализации предложений и повышения качества услуг.",
      "2.4. Оформление и регулирование договорных отношений между Субъектом и Оператором.",
      "2.5. Отражение информации во внутренних базах данных Оператора.",
      "2.6. Осуществление действий, необходимых для взаимодействия Оператора и Субъекта в рамках существующих или возможных правоотношений.",
      "2.7. Передача персональных данных третьим лицам в порядке и на условиях, предусмотренных Политикой и договорами Оператора."
    ],
  },
  {
    id: 3,
    title: "3. Перечень персональных данных",
    content: [
      "3.1. Имя, фамилия, отчество (при наличии).",
      "3.2. Абонентский номер телефона.",
      "3.3. Адрес электронной почты (при наличии).",
      "3.4. Иные персональные данные, предоставленные Субъектом при заполнении форм на Сайте, при обращении в мессенджеры или иным образом.",
      "3.5. Идентификаторы устройств, Cookie и иные технические данные, полученные в процессе использования Сайта."
    ],
  },
  {
    id: 4,
    title: "4. Действия с персональными данными",
    content: [
      "4.1. Сбор, запись, систематизация, накопление.",
      "4.2. Хранение, уточнение (обновление, изменение).",
      "4.3. Извлечение, использование.",
      "4.4. Передача (распространение, предоставление, доступ), в том числе трансграничная передача, при условии соблюдения законодательства.",
      "4.5. Обезличивание, блокирование, удаление, уничтожение.",
      "4.6. Обработка осуществляется в автоматизированной, неавтоматизированной и смешанной форме."
    ],
  },
  {
    id: 5,
    title: "5. Сроки обработки и порядок отзыва согласия",
    content: [
      "5.1. Настоящее Согласие действует с момента предоставления Субъектом персональных данных и до момента его отзыва.",
      "5.2. Субъект вправе в любой момент отозвать согласие, направив письменное уведомление Оператору.",
      "5.3. После получения уведомления об отзыве Оператор прекращает обработку персональных данных в течение 3 (трёх) рабочих дней и уведомляет Субъекта об этом в течение 10 (десяти) рабочих дней.",
      "5.4. Персональные данные уничтожаются при наступлении следующих событий:",
      "5.4.1. прекращение деятельности Оператора;",
      "5.4.2. ликвидация или реорганизация Оператора;",
      "5.4.3. истечение срока хранения, установленного Политикой;",
      "5.4.4. отзыв Субъектом согласия."
    ],
  },
  {
    id: 6,
    title: "6. Права Субъекта",
    content: [
      "6.1. Получать информацию об обработке своих персональных данных, включая сведения о целях, способах, сроках обработки и лицах, которым они передаются.",
      "6.2. Требовать уточнения, блокирования или уничтожения своих персональных данных в случаях, предусмотренных законодательством.",
      "6.3. Отказываться от получения рекламных материалов и массовых обзвонов в порядке, установленном законодательством РФ."
    ],
  },
  {
    id: 7,
    title: "7. Заключительные положения",
    content: [
      "7.1. Я подтверждаю, что Согласие является конкретным, информированным, предметным, сознательным и однозначным.",
      "7.2. Я ознакомлен(а) с Политикой обработки персональных данных и файлов Cookie, размещённой на Сайте.",
      "7.3. Я подтверждаю, что действую добровольно, осознанно и в собственных интересах."
    ],
  },
  {
    id: 8,
    title: "8. Обработка биометрических данных и данных о местоположении",
    content: [
      "8.1. В отдельных случаях и при условии получения отдельного согласия Субъекта, Оператор вправе осуществлять обработку биометрических персональных данных (например, фотоизображений, голосовых данных, параметров устройства), если такая обработка необходима для идентификации личности или предоставления услуг.",
      "8.2. Субъект подтверждает, что понимает особый характер биометрических данных, и соглашается на их обработку исключительно в целях:",
      "8.2.1. обеспечения безопасности и идентификации Субъекта;",
      "8.2.2. повышения качества взаимодействия с Оператором;",
      "8.2.3. предоставления доступа к функциям Сайта, требующим такой обработки.",
      "8.3. В целях повышения качества услуг и персонализации предложений, Субъект предоставляет согласие на обработку данных о местоположении, в том числе:",
      "8.3.1. данных о геолокации устройства;",
      "8.3.2. данных GPS, Wi-Fi, Bluetooth и иных аналогичных технологий;",
      "8.3.3. сопоставления информации о местоположении с иными персональными данными Субъекта.",
      "8.4. Обработка биометрических данных и геолокационных данных осуществляется Оператором в строгом соответствии с Федеральным законом № 152-ФЗ «О персональных данных», Федеральным законом № 152-ФЗ (ред. 2023–2025 гг.) и иными действующими нормативными актами Российской Федерации.",
      "8.5. Биометрические и геолокационные данные могут передаваться третьим лицам (включая партнёров Оператора), если это необходимо для достижения целей обработки и с соблюдением законодательства Российской Федерации.",
      "8.6. Субъект вправе в любой момент отозвать согласие на обработку биометрических данных и/или данных о местоположении путём направления письменного уведомления Оператору. В таком случае обработка будет прекращена в срок, установленный законодательством."
    ],
  },
];

export default function PersonalDataConsentPage() {
  return (
    <div className={styles.container}>
      <h1 className={styles.heading}>СОГЛАСИЕ НА ОБРАБОТКУ ПЕРСОНАЛЬНЫХ ДАННЫХ</h1>
      {introContent.map((paragraph, index) => (
        <p key={`intro-${index}`} className={styles.lead}>
          {renderContentWithLinks(paragraph)}
        </p>
      ))}
      <ul className={styles.sections}>
        {sections.map(({ id, title, content }) => (
          <li key={id} className={styles.section}>
            <div className={styles.side}>
              <h2 className={styles.title}>{title}</h2>
            </div>
            <div className={styles.content}>
              {content.map((line, index) => (
                <p key={index} className={line.startsWith("—") ? styles.bullet : ""}>
                  {renderContentWithLinks(line)}
                </p>
              ))}
            </div>
          </li>
        ))}
      </ul>
    </div>
  );
}
